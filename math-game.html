<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5th Grade Math Challenge</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Comic Sans MS', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .game-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .score-board {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 10px;
        }
        
        .score-item {
            text-align: center;
        }
        
        .score-label {
            font-size: 0.9em;
            color: #666;
        }
        
        .score-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #667eea;
        }
        
        .question-area {
            background: #f9f9f9;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 25px;
            min-height: 200px;
        }
        
        .question-text {
            font-size: 1.4em;
            color: #333;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .answer-options {
            display: grid;
            gap: 15px;
        }
        
        .answer-btn {
            padding: 15px;
            font-size: 1.1em;
            border: 3px solid #667eea;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .answer-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }
        
        .answer-btn.correct {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }
        
        .answer-btn.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }
        
        .answer-btn:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .feedback {
            text-align: center;
            font-size: 1.3em;
            margin: 20px 0;
            font-weight: bold;
            min-height: 30px;
        }
        
        .feedback.correct {
            color: #4CAF50;
        }
        
        .feedback.incorrect {
            color: #f44336;
        }
        
        .next-btn {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .next-btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }
        
        .next-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .end-screen {
            text-align: center;
        }
        
        .end-screen h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
        }
        
        .final-score {
            font-size: 3em;
            color: #4CAF50;
            margin: 20px 0;
        }
        
        .play-again-btn {
            padding: 15px 40px;
            font-size: 1.2em;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 20px;
        }
        
        .play-again-btn:hover {
            background: #45a049;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>ðŸŽ® Math Challenge!</h1>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div class="score-board">
            <div class="score-item">
                <div class="score-label">Question</div>
                <div class="score-value" id="questionNum">1/10</div>
            </div>
            <div class="score-item">
                <div class="score-label">Score</div>
                <div class="score-value" id="score">0</div>
            </div>
            <div class="score-item">
                <div class="score-label">Streak</div>
                <div class="score-value" id="streak">0ðŸ”¥</div>
            </div>
        </div>
        
        <div id="gameArea">
            <div class="question-area">
                <div class="question-text" id="questionText"></div>
                <div class="answer-options" id="answerOptions"></div>
            </div>
            
            <div class="feedback" id="feedback"></div>
            
            <button class="next-btn" id="nextBtn" disabled>Next Question</button>
        </div>
        
        <div id="endScreen" style="display: none;">
            <div class="end-screen">
                <h2>ðŸŽ‰ Great Job!</h2>
                <div class="final-score" id="finalScore"></div>
                <p style="font-size: 1.2em; color: #666;">Keep practicing to become a math master!</p>
                <button class="play-again-btn" onclick="location.reload()">Play Again</button>
            </div>
        </div>
    </div>

    <script>
        let currentQuestion = 0;
        let score = 0;
        let streak = 0;
        let answered = false;
        let currentProblem = null;
        const totalQuestions = 10;

        // Utility function to get random integer between min and max (inclusive)
        function randInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // Utility function to shuffle an array
        function shuffle(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // GCD function for simplifying fractions
        function gcd(a, b) {
            return b === 0 ? a : gcd(b, a % b);
        }

        // Problem generators
        function generateAddition() {
            const a = randInt(10, 99);
            const b = randInt(10, 99);
            const answer = a + b;

            return {
                question: `What is ${a} + ${b}?`,
                correctAnswer: answer.toString(),
                wrongAnswers: [
                    (answer + randInt(1, 10)).toString(),
                    (answer - randInt(1, 10)).toString(),
                    (a + b + randInt(11, 20)).toString()
                ]
            };
        }

        function generateSubtraction() {
            const a = randInt(50, 200);
            const b = randInt(10, a - 10);
            const answer = a - b;

            return {
                question: `What is ${a} - ${b}?`,
                correctAnswer: answer.toString(),
                wrongAnswers: [
                    (answer + randInt(1, 15)).toString(),
                    (answer - randInt(1, 15)).toString(),
                    (a + b).toString()
                ]
            };
        }

        function generateMultiplication() {
            const a = randInt(6, 15);
            const b = randInt(6, 15);
            const answer = a * b;

            return {
                question: `What is ${a} Ã— ${b}?`,
                correctAnswer: answer.toString(),
                wrongAnswers: [
                    (answer + a).toString(),
                    (answer - b).toString(),
                    (answer + randInt(5, 20)).toString()
                ]
            };
        }

        function generateDivision() {
            const divisor = randInt(6, 12);
            const quotient = randInt(8, 15);
            const dividend = divisor * quotient;

            return {
                question: `What is ${dividend} Ã· ${divisor}?`,
                correctAnswer: quotient.toString(),
                wrongAnswers: [
                    (quotient + 1).toString(),
                    (quotient - 1).toString(),
                    (quotient + randInt(2, 5)).toString()
                ]
            };
        }

        function generateFraction() {
            const denominators = [4, 5, 8, 10];
            const denom = denominators[randInt(0, denominators.length - 1)];
            const num = randInt(1, denom - 1);
            const decimal = (num / denom).toFixed(2);

            // Simplify fraction
            const divisor = gcd(num, denom);
            const simplifiedNum = num / divisor;
            const simplifiedDenom = denom / divisor;
            const answer = `${simplifiedNum}/${simplifiedDenom}`;

            return {
                question: `What is ${decimal} as a fraction in simplest form?`,
                correctAnswer: answer,
                wrongAnswers: [
                    `${num}/${denom}`,
                    `${simplifiedNum * 2}/${simplifiedDenom * 2}`,
                    `${simplifiedNum + 1}/${simplifiedDenom}`
                ].filter(ans => ans !== answer)
            };
        }

        function generateArea() {
            const length = randInt(6, 20);
            const width = randInt(4, 15);
            const answer = length * width;

            return {
                question: `If a rectangle has a length of ${length} cm and width of ${width} cm, what is its area?`,
                correctAnswer: `${answer} cmÂ²`,
                wrongAnswers: [
                    `${length + width} cmÂ²`,
                    `${2 * (length + width)} cmÂ²`,
                    `${answer + randInt(5, 15)} cmÂ²`
                ]
            };
        }

        function generatePerimeter() {
            const side = randInt(5, 15);
            const answer = side * 4;

            return {
                question: `What is the perimeter of a square with sides of ${side} inches?`,
                correctAnswer: `${answer} inches`,
                wrongAnswers: [
                    `${side * side} inches`,
                    `${side * 2} inches`,
                    `${side * 3} inches`
                ]
            };
        }

        function generateMoneyProblem() {
            const start = (randInt(20, 80) + randInt(0, 99) / 100).toFixed(2);
            const spent = (randInt(5, parseFloat(start) - 5) + randInt(0, 99) / 100).toFixed(2);
            const answer = (parseFloat(start) - parseFloat(spent)).toFixed(2);

            const names = ['Sarah', 'Alex', 'Maria', 'James', 'Emma'];
            const items = ['book', 'toy', 'game', 'shirt', 'snack'];
            const name = names[randInt(0, names.length - 1)];
            const item = items[randInt(0, items.length - 1)];

            return {
                question: `${name} has $${start}. They buy a ${item} for $${spent}. How much do they have left?`,
                correctAnswer: `$${answer}`,
                wrongAnswers: [
                    `$${(parseFloat(answer) + 0.25).toFixed(2)}`,
                    `$${(parseFloat(answer) - 0.25).toFixed(2)}`,
                    `$${(parseFloat(start) + parseFloat(spent)).toFixed(2)}`
                ]
            };
        }

        function generateWordProblem() {
            const total = randInt(80, 200);
            const perBox = randInt(6, 15);
            const answer = Math.floor(total / perBox);

            const items = ['cookies', 'cupcakes', 'pencils', 'books', 'apples'];
            const containers = ['boxes', 'bags', 'packs', 'crates', 'baskets'];
            const item = items[randInt(0, items.length - 1)];
            const container = containers[randInt(0, containers.length - 1)];

            return {
                question: `A store has ${total} ${item}. If they pack them into ${container} of ${perBox}, how many ${container} do they need?`,
                correctAnswer: `${answer} ${container}`,
                wrongAnswers: [
                    `${answer + 1} ${container}`,
                    `${answer - 1} ${container}`,
                    `${answer + 2} ${container}`
                ]
            };
        }

        function generatePlaceValue() {
            const digits = [randInt(1, 9), randInt(0, 9), randInt(0, 9), randInt(0, 9), randInt(0, 9)];
            const number = digits.join('');
            const formattedNumber = parseInt(number).toLocaleString();

            const position = randInt(0, 4);
            const digit = digits[position];
            const values = [1, 10, 100, 1000, 10000];
            const valueNames = ['1', '10', '100', '1,000', '10,000'];
            const answer = (digit * values[4 - position]).toLocaleString();

            return {
                question: `What is the value of the ${digit} in the number ${formattedNumber}?`,
                correctAnswer: answer,
                wrongAnswers: [
                    digit.toString(),
                    (digit * values[4 - position - 1]).toLocaleString(),
                    (digit * values[4 - position + 1] || digit * 100000).toLocaleString()
                ].filter((val, idx, arr) => arr.indexOf(val) === idx && val !== answer)
            };
        }

        // Generate a random problem
        function generateProblem() {
            const problemTypes = [
                generateAddition,
                generateSubtraction,
                generateMultiplication,
                generateDivision,
                generateFraction,
                generateArea,
                generatePerimeter,
                generateMoneyProblem,
                generateWordProblem,
                generatePlaceValue
            ];

            const generator = problemTypes[randInt(0, problemTypes.length - 1)];
            const problem = generator();

            // Ensure we have exactly 3 wrong answers
            while (problem.wrongAnswers.length < 3) {
                problem.wrongAnswers.push(problem.correctAnswer + randInt(1, 10));
            }
            problem.wrongAnswers = problem.wrongAnswers.slice(0, 3);

            // Create shuffled answers array
            const allAnswers = [problem.correctAnswer, ...problem.wrongAnswers];
            const shuffledAnswers = shuffle(allAnswers);

            return {
                question: problem.question,
                answers: shuffledAnswers,
                correct: shuffledAnswers.indexOf(problem.correctAnswer)
            };
        }

        function loadQuestion() {
            answered = false;
            currentProblem = generateProblem();

            document.getElementById('questionText').textContent = currentProblem.question;
            document.getElementById('questionNum').textContent = `${currentQuestion + 1}/${totalQuestions}`;
            document.getElementById('feedback').textContent = '';
            document.getElementById('nextBtn').disabled = true;

            const progress = ((currentQuestion) / totalQuestions) * 100;
            document.getElementById('progressFill').style.width = progress + '%';

            const optionsContainer = document.getElementById('answerOptions');
            optionsContainer.innerHTML = '';

            currentProblem.answers.forEach((answer, index) => {
                const btn = document.createElement('button');
                btn.className = 'answer-btn';
                btn.textContent = answer;
                btn.onclick = () => checkAnswer(index);
                optionsContainer.appendChild(btn);
            });
        }

        function checkAnswer(selected) {
            if (answered) return;
            answered = true;

            const buttons = document.querySelectorAll('.answer-btn');
            const feedback = document.getElementById('feedback');

            buttons.forEach((btn, index) => {
                btn.disabled = true;
                if (index === currentProblem.correct) {
                    btn.classList.add('correct');
                } else if (index === selected && selected !== currentProblem.correct) {
                    btn.classList.add('incorrect');
                }
            });

            if (selected === currentProblem.correct) {
                score += 10;
                streak++;
                feedback.textContent = 'âœ“ Correct! Great job!';
                feedback.className = 'feedback correct';
            } else {
                streak = 0;
                feedback.textContent = 'âœ— Not quite. Keep trying!';
                feedback.className = 'feedback incorrect';
            }

            document.getElementById('score').textContent = score;
            document.getElementById('streak').textContent = streak + 'ðŸ”¥';
            document.getElementById('nextBtn').disabled = false;
        }

        function nextQuestion() {
            currentQuestion++;

            if (currentQuestion < totalQuestions) {
                loadQuestion();
            } else {
                showEndScreen();
            }
        }

        function showEndScreen() {
            document.getElementById('gameArea').style.display = 'none';
            document.getElementById('endScreen').style.display = 'block';
            document.getElementById('progressFill').style.width = '100%';
            
            const percentage = (score / 100) * 100;
            let message = '';
            
            if (percentage >= 90) {
                message = 'ðŸŒŸ Outstanding! You\'re a math superstar!';
            } else if (percentage >= 70) {
                message = 'ðŸ‘ Great work! Keep it up!';
            } else if (percentage >= 50) {
                message = 'ðŸ’ª Good effort! Practice makes perfect!';
            } else {
                message = 'ðŸŽ¯ Keep practicing! You\'ll get better!';
            }
            
            document.getElementById('finalScore').textContent = `${score}/100`;
            document.querySelector('.end-screen p').textContent = message;
        }

        document.getElementById('nextBtn').onclick = nextQuestion;

        // Load first question
        loadQuestion();
    </script>
</body>
</html>